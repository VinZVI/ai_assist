# –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é AI-–ö–æ–º–ø–∞–Ω—å–æ–Ω

## üìã –û–±–∑–æ—Ä

–î–∞–Ω–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞ AI-–ö–æ–º–ø–∞–Ω—å–æ–Ω, –≤–∫–ª—é—á–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–µ—Å—Ç–æ–≤, –∫–∞—Ä—Ç—É –ø–æ–∫—Ä—ã—Ç–∏—è –∫–æ–¥–∞, –ø–∞—Ç—Ç–µ—Ä–Ω—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –Ω–∞–ø–∏—Å–∞–Ω–∏—é –Ω–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤.

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-09-20  
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2025-10-07  
**–û–±—â–µ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞:** 68% (560/1752 —Å—Ç—Ä–æ–∫ –Ω–µ –ø–æ–∫—Ä—ã—Ç—ã)

---

## üèóÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤

### –ö–æ—Ä–Ω–µ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

```
tests/
‚îú‚îÄ‚îÄ __init__.py                 # –û—Å–Ω–æ–≤–Ω–æ–π –ø–∞–∫–µ—Ç —Ç–µ—Å—Ç–æ–≤
‚îú‚îÄ‚îÄ conftest.py                # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è pytest –∏ –æ–±—â–∏–µ —Ñ–∏–∫—Å—Ç—É—Ä—ã
‚îú‚îÄ‚îÄ fixtures/                  # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ —Ñ–∏–∫—Å—Ç—É—Ä—ã
‚îÇ   ‚îî‚îÄ‚îÄ __init__.py
‚îú‚îÄ‚îÄ unit/                      # –Æ–Ω–∏—Ç-—Ç–µ—Å—Ç—ã –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ test_callbacks.py       # –¢–µ—Å—Ç—ã –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ callback-–∑–∞–ø—Ä–æ—Å–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ test_config.py         # –¢–µ—Å—Ç—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (9.8KB)
‚îÇ   ‚îú‚îÄ‚îÄ test_handlers.py       # –¢–µ—Å—Ç—ã –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ (–Ω–æ–≤—ã–π —Ñ–∞–π–ª)
‚îÇ   ‚îî‚îÄ‚îÄ test_models.py         # –¢–µ—Å—Ç—ã –º–æ–¥–µ–ª–µ–π –¥–∞–Ω–Ω—ã—Ö (20.4KB)
‚îú‚îÄ‚îÄ integration/               # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ test_ai_manager.py     # –¢–µ—Å—Ç—ã AI –º–µ–Ω–µ–¥–∂–µ—Ä–∞ (–Ω–æ–≤—ã–π —Ñ–∞–π–ª)
‚îÇ   ‚îú‚îÄ‚îÄ test_ai_service.py     # –¢–µ—Å—Ç—ã AI —Å–µ—Ä–≤–∏—Å–∞ (18.0KB)
‚îÇ   ‚îú‚îÄ‚îÄ test_database.py       # –¢–µ—Å—Ç—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (17.3KB)
‚îÇ   ‚îú‚îÄ‚îÄ test_message_handler.py # –¢–µ—Å—Ç—ã –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π (22.4KB)
‚îÇ   ‚îî‚îÄ‚îÄ test_user_service.py    # –¢–µ—Å—Ç—ã —Å–µ—Ä–≤–∏—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–Ω–æ–≤—ã–π —Ñ–∞–π–ª)
‚îî‚îÄ‚îÄ conftest.py                # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è pytest

scripts/
‚îú‚îÄ‚îÄ __init__.py
‚îú‚îÄ‚îÄ checks/                    # –°–∫—Ä–∏–ø—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ test_config_simple.py  # –ü—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (3.3KB)
‚îÇ   ‚îú‚îÄ‚îÄ test_db_connection.py  # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î (4.3KB)
‚îÇ   ‚îî‚îÄ‚îÄ test_openrouter_integration.py # –ü—Ä–æ–≤–µ—Ä–∫–∞ OpenRouter (5.6KB)
‚îî‚îÄ‚îÄ diagnostics/               # –î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–µ —Å–∫—Ä–∏–ø—Ç—ã
    ‚îú‚îÄ‚îÄ check_deepseek_api.py  # –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ DeepSeek API (8.8KB)
    ‚îî‚îÄ‚îÄ check_imports.py       # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–º–ø–æ—Ä—Ç–æ–≤ (1.8KB)
```

### –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ç–µ—Å—Ç–æ–≤

#### üî¨ –Æ–Ω–∏—Ç-—Ç–µ—Å—Ç—ã (`tests/unit/`)
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –≤ –∏–∑–æ–ª—è—Ü–∏–∏
- **–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏**: –ë—ã—Å—Ç—Ä—ã–µ, –±–µ–∑ –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π, –º–æ–∫–∏ –¥–ª—è –≤—Å–µ—Ö –≤–Ω–µ—à–Ω–∏—Ö –≤—ã–∑–æ–≤–æ–≤
- **–§–∞–π–ª—ã**: test_callbacks.py, test_config.py, test_handlers.py, test_models.py

#### üîó –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã (`tests/integration/`)
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏
- **–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏**: –ú–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î/API
- **–§–∞–π–ª—ã**: test_ai_manager.py, test_ai_service.py, test_database.py, test_message_handler.py, test_user_service.py

#### ‚úÖ –°–∫—Ä–∏–ø—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ (`scripts/checks/`)
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- **–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏**: –ê–≤—Ç–æ–Ω–æ–º–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

#### üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–µ —Å–∫—Ä–∏–ø—Ç—ã (`scripts/diagnostics/`)
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ì–ª—É–±–æ–∫–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º –∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
- **–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏**: –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏

---

## üìä –ö–∞—Ä—Ç–∞ –ø–æ–∫—Ä—ã—Ç–∏—è –∫–æ–¥–∞ —Ç–µ—Å—Ç–∞–º–∏

### –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–∫—Ä—ã—Ç–∏—è

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ü–æ–∫—Ä—ã—Ç–∏–µ | –°—Ç—Ä–æ–∫ –ø–æ–∫—Ä—ã—Ç–æ | –í—Å–µ–≥–æ —Å—Ç—Ä–æ–∫ | –°—Ç–∞—Ç—É—Å |
|-----------|----------|---------------|-------------|---------|
| **–û–±—â–µ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ** | **78%** | **1367** | **1752** | üü° –ß–∞—Å—Ç–∏—á–Ω–æ |

### –î–µ—Ç–∞–ª—å–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ –ø–æ –º–æ–¥—É–ª—è–º

#### ‚úÖ –í—ã—Å–æ–∫–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ (80-100%)

| –ú–æ–¥—É–ª—å | –ü–æ–∫—Ä—ã—Ç–∏–µ | –°—Ç—Ä–æ–∫ –Ω–µ –ø–æ–∫—Ä—ã—Ç–æ | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|--------|----------|------------------|-------------|
| `app/__init__.py` | 100% | 0/3 | ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–∫—Ä—ã—Ç–æ |
| `app/handlers/__init__.py` | 100% | 0/5 | ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–∫—Ä—ã—Ç–æ |
| `app/keyboards/__init__.py` | 100% | 0/2 | ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–∫—Ä—ã—Ç–æ |
| `app/models/__init__.py` | 100% | 0/4 | ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–∫—Ä—ã—Ç–æ |
| `app/services/__init__.py` | 100% | 0/2 | ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–∫—Ä—ã—Ç–æ |
| `app/services/ai_providers/__init__.py` | 100% | 0/4 | ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–∫—Ä—ã—Ç–æ |
| `app/utils/__init__.py` | 100% | 0/0 | ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–∫—Ä—ã—Ç–æ |
| `app/database.py` | 95% | 7/137 | ‚úÖ –•–æ—Ä–æ—à–µ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ |
| `app/config.py` | 89% | 28/254 | ‚úÖ –•–æ—Ä–æ—à–µ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ |
| `app/models/conversation.py` | 82% | 21/114 | ‚úÖ –•–æ—Ä–æ—à–µ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ |
| `app/models/user.py` | 85% | 15/97 | ‚úÖ –•–æ—Ä–æ—à–µ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ |

#### üü° –°—Ä–µ–¥–Ω–µ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ (50-79%)

| –ú–æ–¥—É–ª—å | –ü–æ–∫—Ä—ã—Ç–∏–µ | –°—Ç—Ä–æ–∫ –Ω–µ –ø–æ–∫—Ä—ã—Ç–æ | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|--------|----------|------------------|-------------|
| `app/services/ai_service.py` | 67% | 61/185 | üü° –ù—É–∂–¥–∞–µ—Ç—Å—è –≤ –¥–æ—Ä–∞–±–æ—Ç–∫–µ |
| `app/services/ai_providers/base.py` | 65% | 26/74 | üü° –ù—É–∂–¥–∞–µ—Ç—Å—è –≤ –¥–æ—Ä–∞–±–æ—Ç–∫–µ |
| `app/utils/logging.py` | 59% | 23/56 | üü° –ù—É–∂–¥–∞–µ—Ç—Å—è –≤ –¥–æ—Ä–∞–±–æ—Ç–∫–µ |
| `app/log_lexicon/__init__.py` | 100% | 0/4 | ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–∫—Ä—ã—Ç–æ |
| `app/log_lexicon/en.py` | 100% | 0/130 | ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–∫—Ä—ã—Ç–æ |
| `app/log_lexicon/ru.py` | 100% | 0/130 | ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–∫—Ä—ã—Ç–æ |

#### üî¥ –ù–∏–∑–∫–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ (0-49%)

| –ú–æ–¥—É–ª—å | –ü–æ–∫—Ä—ã—Ç–∏–µ | –°—Ç—Ä–æ–∫ –Ω–µ –ø–æ–∫—Ä—ã—Ç–æ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç |
|--------|----------|------------------|-----------|
| `app/handlers/callbacks.py` | 28% | 84/116 | üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –Ω–∏–∑–∫–æ |
| `app/handlers/message.py` | 45% | 71/129 | üü° –£–ª—É—á—à–µ–Ω–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ |
| `app/keyboards/inline.py` | 23% | 43/56 | üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –Ω–∏–∑–∫–æ |
| `app/handlers/start.py` | 20% | 68/85 | üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –Ω–∏–∑–∫–æ |
| `app/services/ai_manager.py` | 18% | 145/177 | üî¥ **–ü–†–ò–û–†–ò–¢–ï–¢ 1** |
| `app/services/ai_providers/deepseek.py` | 13% | 109/126 | üî¥ **–ü–†–ò–û–†–ò–¢–ï–¢ 2** |
| `app/services/ai_providers/openrouter.py` | 13% | 109/126 | üî¥ **–ü–†–ò–û–†–ò–¢–ï–¢ 3** |

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –±–µ–∑ –ø–æ–∫—Ä—ã—Ç–∏—è

#### üö® –í—ã—Å—à–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç

1. **`app/services/ai_manager.py` (18% –ø–æ–∫—Ä—ã—Ç–∏—è)**
   - **–§—É–Ω–∫—Ü–∏–∏ –±–µ–∑ –ø–æ–∫—Ä—ã—Ç–∏—è**: 
     - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è AIManager
     - –ú–µ—Ö–∞–Ω–∏–∑–º fallback –º–µ–∂–¥—É –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º–∏
     - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤
     - –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤
     - Health check –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤
   - **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å**: –ö–ª—é—á–µ–≤–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –Ω–æ–≤–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

2. **`app/services/ai_providers/openrouter.py` (13% –ø–æ–∫—Ä—ã—Ç–∏—è)**
   - **–§—É–Ω–∫—Ü–∏–∏ –±–µ–∑ –ø–æ–∫—Ä—ã—Ç–∏—è**:
     - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è OpenRouter –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞
     - HTTP –∑–∞–ø—Ä–æ—Å—ã –∫ OpenRouter API
     - –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ API (401, 402, 429, 5xx)
     - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–æ–≤
   - **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å**: –û—Å–Ω–æ–≤–Ω–æ–π –Ω–æ–≤—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

3. **`app/services/ai_providers/deepseek.py` (13% –ø–æ–∫—Ä—ã—Ç–∏—è)**
   - **–§—É–Ω–∫—Ü–∏–∏ –±–µ–∑ –ø–æ–∫—Ä—ã—Ç–∏—è**:
     - –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ DeepSeek –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞
     - HTTP –∑–∞–ø—Ä–æ—Å—ã –∫ DeepSeek API
     - –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ API
     - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–æ–≤
   - **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å**: –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞

#### üî• –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç

4. **`app/handlers/message.py` (26% –ø–æ–∫—Ä—ã—Ç–∏—è)**
   - **–§—É–Ω–∫—Ü–∏–∏ –±–µ–∑ –ø–æ–∫—Ä—ã—Ç–∏—è**:
     - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –Ω–æ–≤—ã–º AIManager
     - –û–±—Ä–∞–±–æ—Ç–∫–∞ fallback –ª–æ–≥–∏–∫–∏
     - –í–∞–ª–∏–¥–∞—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π
     - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∏–∞–ª–æ–≥–æ–≤
   - **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å**: –û—Å–Ω–æ–≤–Ω–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

5. **`app/handlers/callbacks.py` (28% –ø–æ–∫—Ä—ã—Ç–∏—è)**
   - **–§—É–Ω–∫—Ü–∏–∏ –±–µ–∑ –ø–æ–∫—Ä—ã—Ç–∏—è**:
     - Inline –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
     - Callback –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
     - –ü—Ä–µ–º–∏—É–º —Ñ—É–Ω–∫—Ü–∏–∏
   - **–ö—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

---

## üß™ –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–µ—Å—Ç—ã

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Ç–µ—Å—Ç–∞–º

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–µ—Å—Ç–æ–≤ | –°—Ç–∞—Ç—É—Å |
|-----------|-------------------|---------|
| **–í—Å–µ–≥–æ —Å–æ–±—Ä–∞–Ω–æ** | 185 —Ç–µ—Å—Ç–æ–≤ | ‚úÖ |
| **–ü—Ä–æ—à–ª–∏ —É—Å–ø–µ—à–Ω–æ** | 132 —Ç–µ—Å—Ç–æ–≤ | ‚úÖ |
| **–ü—Ä–æ–≤–∞–ª–∏–ª–∏—Å—å** | 33 —Ç–µ—Å—Ç–æ–≤ | ‚ùå |
| **–ü—Ä–æ–ø—É—â–µ–Ω—ã** | 10 —Ç–µ—Å—Ç–æ–≤ | ‚è≠Ô∏è |
| **–û—à–∏–±–∫–∏** | 7 —Ç–µ—Å—Ç–æ–≤ | üí• |

### –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ —Ñ–∞–π–ª–∞–º

#### üìÅ tests/unit/test_config.py
- **–í—Å–µ–≥–æ —Ç–µ—Å—Ç–æ–≤**: 11
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
- **–û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã**:
  - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã —Å .env.example —Ñ–∞–π–ª–æ–º
  - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π Pydantic
  - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –ø—É—Ç–∏ –∫ —Ñ–∞–π–ª–∞–º

#### üìÅ tests/unit/test_models.py  
- **–í—Å–µ–≥–æ —Ç–µ—Å—Ç–æ–≤**: 25
- **–°—Ç–∞—Ç—É—Å**: üü° –£–ª—É—á—à–µ–Ω–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ
- **–û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã**:
  - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å —Ç–µ–∫—É—â–∏–º–∏ –º–æ–¥–µ–ª—è–º–∏ SQLAlchemy
  - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã —Å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º–∏ —Ñ–∏–∫—Å—Ç—É—Ä–∞–º–∏
  - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –∏–º–µ–Ω–∞ –ø–æ–ª–µ–π –≤ User –º–æ–¥–µ–ª–∏
  - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã —Å Pydantic —Å—Ö–µ–º–∞–º–∏

#### üìÅ tests/integration/test_ai_manager.py
- **–í—Å–µ–≥–æ —Ç–µ—Å—Ç–æ–≤**: 28
- **–°—Ç–∞—Ç—É—Å**: üü° –£–ª—É—á—à–µ–Ω–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ
- **–û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã**:
  - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã —Å –º–æ–∫–∞–º–∏ –¥–ª—è –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤
  - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –æ—à–∏–±–∫–∏ –≤ —Ç–µ—Å—Ç–∞—Ö fallback –ª–æ–≥–∏–∫–∏
  - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã —Å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏

#### üìÅ tests/integration/test_ai_service.py
- **–í—Å–µ–≥–æ —Ç–µ—Å—Ç–æ–≤**: 29  
- **–°—Ç–∞—Ç—É—Å**: üü° –£–ª—É—á—à–µ–Ω–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ
- **–û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã**:
  - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã —Å –º–æ–∫–∞–º–∏ –¥–ª—è AI –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤
  - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –æ—à–∏–±–∫–∏ –≤ —Ç–µ—Å—Ç–∞—Ö –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤
  - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã —Å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏

#### üìÅ tests/integration/test_database.py
- **–í—Å–µ–≥–æ —Ç–µ—Å—Ç–æ–≤**: 32
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
- **–û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã**:
  - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã —Å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–º–∏ –º–µ–Ω–µ–¥–∂–µ—Ä–∞–º–∏
  - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –æ—à–∏–±–∫–∏ –≤ —Ç–µ—Å—Ç–∞—Ö —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü
  - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã —Å —Ñ–∏–∫—Å—Ç—É—Ä–∞–º–∏

#### üìÅ tests/integration/test_message_handler.py
- **–í—Å–µ–≥–æ —Ç–µ—Å—Ç–æ–≤**: 35
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
- **–û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã**:
  - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã —Å –º–æ–∫–∞–º–∏ –¥–ª—è —Å–µ—Å—Å–∏–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
  - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –æ—à–∏–±–∫–∏ –≤ —Ç–µ—Å—Ç–∞—Ö –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ AI –æ—Ç–≤–µ—Ç–æ–≤
  - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã —Å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏

#### üìÅ tests/unit/test_callbacks.py
- **–í—Å–µ–≥–æ —Ç–µ—Å—Ç–æ–≤**: 15
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
- **–û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã**:
  - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã —Å –º–æ–∫–∞–º–∏ –¥–ª—è callback-–∑–∞–ø—Ä–æ—Å–æ–≤
  - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –æ—à–∏–±–∫–∏ –≤ —Ç–µ—Å—Ç–∞—Ö inline –∫–ª–∞–≤–∏–∞—Ç—É—Ä

#### üìÅ tests/unit/test_handlers.py
- **–í—Å–µ–≥–æ —Ç–µ—Å—Ç–æ–≤**: 10
- **–°—Ç–∞—Ç—É—Å**: ‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
- **–û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã**:
  - –°–æ–∑–¥–∞–Ω—ã –Ω–æ–≤—ã–µ —Ç–µ—Å—Ç—ã –¥–ª—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –∫–æ–º–∞–Ω–¥
  - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã —Å –º–æ–∫–∞–º–∏ –¥–ª—è Telegram API

---

## üß© –ü–∞—Ç—Ç–µ—Ä–Ω—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### üéØ –û–±—â–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã

1. **–ò–∑–æ–ª—è—Ü–∏—è —Ç–µ—Å—Ç–æ–≤**: –ö–∞–∂–¥—ã–π —Ç–µ—Å—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–º –∏ –Ω–µ –≤–ª–∏—è—Ç—å –Ω–∞ –¥—Ä—É–≥–∏–µ —Ç–µ—Å—Ç—ã
2. **–ü—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç—å**: –¢–µ—Å—Ç—ã –¥–æ–ª–∂–Ω—ã –¥–∞–≤–∞—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—É—Å–∫–µ
3. **–°–∫–æ—Ä–æ—Å—Ç—å**: –¢–µ—Å—Ç—ã –¥–æ–ª–∂–Ω—ã –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –±—ã—Å—Ç—Ä–æ (–º–µ–Ω–µ–µ 1 —Å–µ–∫—É–Ω–¥—ã –Ω–∞ —Ç–µ—Å—Ç)
4. **–ß–∏—Ç–∞–µ–º–æ—Å—Ç—å**: –¢–µ—Å—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ª–µ–≥–∫–æ —á–∏—Ç–∞–µ–º—ã–º–∏ –∏ –ø–æ–Ω—è—Ç–Ω—ã–º–∏

### üß± –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤

#### AAA –ø–∞—Ç—Ç–µ—Ä–Ω (Arrange, Act, Assert)

```python
def test_example():
    # Arrange (–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞)
    mock_data = create_mock_data()
    service = MyService()
    
    # Act (–î–µ–π—Å—Ç–≤–∏–µ)
    result = service.process_data(mock_data)
    
    # Assert (–ü—Ä–æ–≤–µ—Ä–∫–∞)
    assert result == expected_result
```

#### –§–∏–∫—Å—Ç—É—Ä—ã –∏ –º–æ–∫–∏

```python
@pytest.fixture
def mock_user():
    """–§–∏–∫—Å—Ç—É—Ä–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –º–æ–∫-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è."""
    return User(
        id=1,
        telegram_id=123456789,
        username="testuser",
        first_name="Test",
        last_name="User"
    )

@patch("app.services.ai_manager.get_ai_manager")
def test_generate_ai_response_success(mock_get_ai_manager, mock_user):
    """–¢–µ—Å—Ç —É—Å–ø–µ—à–Ω–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–∞ –æ—Ç AI."""
    # Arrange
    mock_manager = Mock()
    mock_get_ai_manager.return_value = mock_manager
    mock_manager.generate_response.return_value = Mock(
        content="Test response",
        tokens_used=10,
        model="test-model",
        response_time=0.5
    )
    
    # Act
    result = generate_ai_response(mock_user, "Hello")
    
    # Assert
    assert len(result) == 4
    assert result[0] == "Test response"
    assert result[1] == 10
```

### üß™ –¢–∏–ø—ã —Ç–µ—Å—Ç–æ–≤

#### üß™ –Æ–Ω–∏—Ç-—Ç–µ—Å—Ç—ã

–¢–µ—Å—Ç–∏—Ä—É—é—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏ –º–µ—Ç–æ–¥—ã –≤ –∏–∑–æ–ª—è—Ü–∏–∏:

```python
def test_user_can_send_message():
    """–¢–µ—Å—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º."""
    user = User(daily_message_count=5, is_premium=False)
    assert user.can_send_message() == True
    
    user.daily_message_count = 100
    assert user.can_send_message() == False
```

#### üîó –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã

–¢–µ—Å—Ç–∏—Ä—É—é—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –º–µ–∂–¥—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏:

```python
@pytest.mark.asyncio
async def test_save_conversation_success():
    """–¢–µ—Å—Ç —É—Å–ø–µ—à–Ω–æ–≥–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∏–∞–ª–æ–≥–∞."""
    # Arrange
    mock_session = AsyncMock()
    user_id = 1
    user_message = "Hello"
    ai_response = "Hi there!"
    
    # Act
    result = await save_conversation(
        session=mock_session,
        user_id=user_id,
        user_message=user_message,
        ai_response=ai_response,
        ai_model="test-model",
        tokens_used=10,
        response_time=0.5
    )
    
    # Assert
    assert result == True
    assert mock_session.add.call_count == 2
    mock_session.commit.assert_called_once()
```

#### üß™ –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã

–¢–µ—Å—Ç–∏—Ä—É—é—Ç –ø–æ–ª–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —Å–∏—Å—Ç–µ–º—ã:

```python
@pytest.mark.asyncio
async def test_full_message_flow():
    """–¢–µ—Å—Ç –ø–æ–ª–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è."""
    # Arrange
    mock_message = create_mock_telegram_message("Hello, AI!")
    
    with patch("app.handlers.message.get_or_update_user") as mock_get_user:
        mock_get_user.return_value = create_mock_user()
        
        with patch("app.handlers.message.generate_ai_response") as mock_generate:
            mock_generate.return_value = ("AI response", 10, "test-model", 0.5)
            
            with patch("app.handlers.message.save_conversation") as mock_save:
                mock_save.return_value = True
                
                # Act
                await handle_text_message(mock_message)
                
                # Assert
                mock_get_user.assert_called_once_with(mock_message)
                mock_generate.assert_called_once()
                mock_save.assert_called_once()
                mock_message.answer.assert_called_once()
```

---

## üõ†Ô∏è –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –Ω–∞–ø–∏—Å–∞–Ω–∏—é —Ç–µ—Å—Ç–æ–≤

### üì¶ –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤

1. **–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ —Ç–∏–ø —Ç–µ—Å—Ç–∞**: –Æ–Ω–∏—Ç, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –∏–ª–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π
2. **–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª —Ç–µ—Å—Ç–∞**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–µ—Ñ–∏–∫—Å `test_` –∏ —Ä–∞–∑–º–µ—Å—Ç–∏—Ç–µ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
3. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∏–º–ø–æ—Ä—Ç—ã**: –ò–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ —Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –º–æ–¥—É–ª–∏
4. **–°–ª–µ–¥—É–π—Ç–µ AAA –ø–∞—Ç—Ç–µ—Ä–Ω—É**: Arrange, Act, Assert
5. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–∏–∫—Å—Ç—É—Ä—ã**: –î–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö
6. **–ú–æ–∫–∞–π—Ç–µ –≤–Ω–µ—à–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `unittest.mock` –∏–ª–∏ `pytest-mock`
7. **–ü–∏—à–∏—Ç–µ –ø–æ–Ω—è—Ç–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–ø–∏—Å–∞—Ç–µ–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏–π
8. **–î–æ–±–∞–≤–ª—è–π—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é**: –ü–∏—à–∏—Ç–µ docstrings –¥–ª—è —Ç–µ—Å—Ç–æ–≤

### üß™ –ü—Ä–∏–º–µ—Ä —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ—Å—Ç–∞

```
# tests/unit/test_example.py

import pytest
from unittest.mock import AsyncMock, patch

from app.services.example_service import process_data
from app.models.user import User

class TestExampleService:
    """–¢–µ—Å—Ç—ã –¥–ª—è –ø—Ä–∏–º–µ—Ä–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞."""
    
    @pytest.fixture
    def mock_user(self) -> User:
        """–§–∏–∫—Å—Ç—É—Ä–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –º–æ–∫-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è."""
        return User(
            id=1,
            telegram_id=123456789,
            username="testuser",
            first_name="Test",
            last_name="User"
        )
    
    @pytest.mark.asyncio
    async def test_process_data_success(self, mock_user):
        """–¢–µ—Å—Ç —É—Å–ø–µ—à–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö."""
        # Arrange
        input_data = "test data"
        expected_result = "processed data"
        
        with patch("app.services.example_service.external_api_call") as mock_api:
            mock_api.return_value = expected_result
            
            # Act
            result = await process_data(mock_user, input_data)
            
            # Assert
            assert result == expected_result
            mock_api.assert_called_once_with(input_data)
```

### üß™ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
uv run pytest

# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º –≤—ã–≤–æ–¥–æ–º
uv run pytest -v

# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º –∫–æ–¥–∞
uv run pytest --cov=app

# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º –∏ –æ—Ç—á–µ—Ç–æ–º –≤ HTML
uv run pytest --cov=app --cov-report=html

# –ó–∞–ø—É—Å–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ —Ç–µ—Å—Ç–æ–≤
uv run pytest tests/unit/test_config.py

# –ó–∞–ø—É—Å–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞
uv run pytest tests/unit/test_config.py::test_load_config_success
```

---

## üìà –ú–µ—Ç—Ä–∏–∫–∏ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### üìä –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤

- **–û–±—â–µ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞**: 68%
- **–í—Å–µ–≥–æ —Ç–µ—Å—Ç–æ–≤**: 185
- **–ü—Ä–æ—à–ª–∏ —É—Å–ø–µ—à–Ω–æ**: 132 (71%)
- **–ü—Ä–æ–≤–∞–ª–∏–ª–∏—Å—å**: 33 (18%)
- **–ü—Ä–æ–ø—É—â–µ–Ω—ã**: 10 (5%)
- **–û—à–∏–±–∫–∏**: 7 (4%)

### üìà –¶–µ–ª–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é

1. **–£–≤–µ–ª–∏—á–∏—Ç—å –æ–±—â–µ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ –¥–æ 85%**
2. **–°–Ω–∏–∑–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–≤–∞–ª–µ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ –¥–æ 5%**
3. **–£—Å—Ç—Ä–∞–Ω–∏—Ç—å –≤—Å–µ –æ—à–∏–±–∫–∏ –≤ —Ç–µ—Å—Ç–∞—Ö**
4. **–î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤**

### üìä –ü–ª–∞–Ω —É–ª—É—á—à–µ–Ω–∏—è

#### üö® –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- [ ] –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è `app/services/ai_manager.py`
- [ ] –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è `app/services/ai_providers/openrouter.py`
- [ ] –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è `app/services/ai_providers/deepseek.py`

#### üî• –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
- [ ] –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è `app/handlers/message.py`
- [ ] –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è `app/handlers/callbacks.py`
- [ ] –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è `app/handlers/start.py`

#### üìà –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3: –£–ª—É—á—à–µ–Ω–∏–µ –ø–æ–∫—Ä—ã—Ç–∏—è
- [ ] –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è `app/keyboards/inline.py`
- [ ] –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è `app/services/ai_service.py`
- [ ] –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è `app/services/ai_providers/base.py`

---

## üìö –†–µ—Å—É—Ä—Å—ã

### üìñ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- [Pytest Documentation](https://docs.pytest.org/)
- [Python Mock Library](https://docs.python.org/3/library/unittest.mock.html)
- [Coverage.py Documentation](https://coverage.readthedocs.io/)

### üõ†Ô∏è –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
- **pytest**: –§—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- **pytest-asyncio**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤
- **pytest-cov**: –ò–∑–º–µ—Ä–µ–Ω–∏–µ –ø–æ–∫—Ä—ã—Ç–∏—è –∫–æ–¥–∞
- **unittest.mock**: –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –º–æ–∫–æ–≤

### üìä –ö–æ–º–∞–Ω–¥—ã

```bash
# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
uv run pytest

# –ó–∞–ø—É—Å–∫ —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º
uv run pytest --cov=app --cov-report=term-missing

# –ó–∞–ø—É—Å–∫ —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º –≤—ã–≤–æ–¥–æ–º
uv run pytest -v

# –ó–∞–ø—É—Å–∫ —Å –æ—Ç—á–µ—Ç–æ–º –≤ HTML
uv run pytest --cov=app --cov-report=html

# –ó–∞–ø—É—Å–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ç–µ—Å—Ç–∞
uv run pytest tests/unit/test_config.py::test_load_config_success
```

---

*–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: 2025-10-07 - –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ç–µ—Å—Ç–æ–≤ –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ –ª–æ–≥-–ª–µ–∫—Å–∏–∫–æ–Ω–æ–≤*